### START TEMPLATE CONFIG
##### DO NOT EDIT THIS FILE DIRECTLY #####

server {
  listen 443 ssl;
  server_name DOMAIN;
  return 301 https://www.DOMAIN;
  ssl_certificate      /web/DOMAIN/conf/ssl/cert.pem;
  ssl_certificate_key  /web/DOMAIN/conf/ssl/key.pem;
  ssl_session_timeout  5m;
}

server {
  listen 443 ssl;
  server_name www.DOMAIN;
  root /web/DOMAIN/live/current/public;
  access_log  /web/DOMAIN/logs/access.log  main;
  error_log  /web/DOMAIN/logs/error.log  error;
  #passenger_ruby /web/DOMAIN/.rvm/wrappers/ruby-1.9.3-p374@OWNER/ruby;
  passenger_enabled on;
  rails_env production;
  gzip on;
  ssl                  on;
  ssl_certificate      /web/DOMAIN/conf/ssl/cert.pem;
  ssl_certificate_key  /web/DOMAIN/conf/ssl/key.pem;
  ssl_session_timeout  5m;
  ssl_protocols  SSLv3 TLSv1;
  ssl_ciphers  RC4-SHA:ECDHE-RSA-AES256-SHA384:AES256-SHA256:+TLSv1:HIGH:!MD5:!SSLv2:!aNULL:!eNULL:!NULL:!DH:!ADH:!EDH:!AESGCM:!EXP;
  ssl_prefer_server_ciphers   on;
}

server {
  listen 443 ssl;
  server_name stage.DOMAIN;
  root /web/DOMAIN/stage/current/public;
  access_log  /web/DOMAIN/logs/stage-access.log  main;
  error_log  /web/DOMAIN/logs/stage-error.log  error;
  #passenger_ruby /web/DOMAIN/.rvm/wrappers/ruby-1.9.3-p374@OWNER/ruby;
  passenger_enabled on;
  rails_env staging;
  gzip on;
  ssl                  on;
  ssl_certificate      /web/DOMAIN/conf/ssl/cert.pem;
  ssl_certificate_key  /web/DOMAIN/conf/ssl/key.pem;
  ssl_session_timeout  5m;
  ssl_protocols  SSLv3 TLSv1;
  ssl_ciphers  RC4-SHA:ECDHE-RSA-AES256-SHA384:AES256-SHA256:+TLSv1:HIGH:!MD5:!SSLv2:!aNULL:!eNULL:!NULL:!DH:!ADH:!EDH:!AESGCM:!EXP;
  ssl_prefer_server_ciphers   on;
  auth_basic	"DOMAIN Staging";
  auth_basic_user_file	/web/DOMAIN/pw/stage.htpw;
}

server {
  listen 443 ssl;
  server_name dev.DOMAIN;
  root /web/DOMAIN/dev/current/public;
  access_log  /web/DOMAIN/logs/dev-access.log  main;
  error_log  /web/DOMAIN/logs/dev-error.log  error;
  #passenger_ruby /web/DOMAIN/.rvm/wrappers/ruby-1.9.3-p374@OWNER/ruby;
  passenger_enabled on;
  rails_env development;
  gzip on;
  ssl                  on;
  ssl_certificate      /web/DOMAIN/conf/ssl/cert.pem;
  ssl_certificate_key  /web/DOMAIN/conf/ssl/key.pem;
  ssl_session_timeout  5m;
  ssl_protocols  SSLv3 TLSv1;
  ssl_ciphers  RC4-SHA:ECDHE-RSA-AES256-SHA384:AES256-SHA256:+TLSv1:HIGH:!MD5:!SSLv2:!aNULL:!eNULL:!NULL:!DH:!ADH:!EDH:!AESGCM:!EXP;
  ssl_prefer_server_ciphers   on;
  auth_basic	"DOMAIN Development";
  auth_basic_user_file	/web/DEFAULT/pw/dev.htpw;
}
